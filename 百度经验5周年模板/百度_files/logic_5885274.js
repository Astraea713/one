define("common-jquery:widget/js/logic/address-dialog/address-dialog.js",function(e,s,i){var t=e("common-jquery:widget/lib/jquery/jquery.js"),d=e("common-jquery:widget/js/ui/dialog/dialog.js"),o=e("common-jquery:widget/js/util/event/event.js"),n=e("common-jquery:widget/js/ui/address/address.js");e("common-jquery:widget/lib/jquery.plugins/form.js"),e("common-jquery:widget/js/logic/login/login.js");var l={init:function(e){var s=this;return e&&e.orderId?(s.options=t.extend({BdsToken:F.context("BdsToken")||F.context("BdStoken"),bdstt:F.context("bdstt"),title:"恭喜恭喜~"},e||{}),void s.getUserAddress(s.render)):void console.error("`orderId` is needed for initialization of address-dialog.")},addressVisability:function(e){t("#sel-city").show(),t("#con-city").css("visibility",""),t("#lbl-city").css("visibility",""),"none"==t("#sel-district").css("display")?(t("#sel-district").show(),t("#con-district").css("visibility","hidden"),t("#lbl-district").css("visibility","hidden")):e.value["sel-district"]&&(t("#con-district").css("visibility",""),t("#lbl-district").css("visibility",""))},initAddress:function(){var e=this,s={container:["#sel-province","#sel-city","#sel-district"],defaultValue:["北京","海淀区"]},i=new n(s);e.addressVisability(i),i.on("change",function(){e.addressVisability(i)})},getUserAddress:function(e){var s=this;F.context("userAddress",{}),t.post("/ajax/shop/getUserAddress",null,function(i){if(i){var d={};t.each(i.address,function(e,s){d[e]=s}),F.context("userAddress",d),e&&e(s)}},"json")},render:function(e){var s=e,i=s.options.orderId,o={orderId:i,BdsToken:F.context("BdsToken")||F.context("BdStoken"),bdstt:F.context("bdstt")},n="";switch(s.options.showType){case 1:n='本次兑换将花费<span class="f-red">'+option.goodsCost+'</span>财富值，您当前持有<span class="f-red">'+trade.userWealth+"</span>财富值";break;case 2:n="<h1>恭喜您，中奖啦！</h1>";break;default:n="<h1>"+s.options.title+"</h1>"}var l=['<div class="dialog-container f-12">','<div class="header">','<span class="close-dialog grid-r">X</span>','<div class="title f-bold">',n,"</div>","请填写收货地址，这件商品就会投向您的怀抱啦~","</div>",'<div class="main mt-10">','<form id="addr-form" class="addr-form">','<div class="line">','<label id="lbl-name" for="ipt-name">收件人姓名：</label><input id="ipt-name" name="recipient" value="',F.context("userAddress").recipient,'" />',"</div>",'<div class="line">','<label id="lbl-province" for="sel-province">所在地区：</label>','<div class="select" id="con-province">','<select id="sel-province" data-save="',F.context("userAddress").province,'" name="province"></select>',"</div>",'<div class="select" id="con-city">','<select id="sel-city" name="city" data-save="',F.context("userAddress").city,'"></select>',"</div>",'<div class="select" id="con-district">','<select id="sel-district" name="district" data-save="',F.context("userAddress").district,'"></select>',"</div>","</div>",'<div class="line">','<label id="lbl-address" for="ipt-address">街道地址：</label><input id="ipt-address" name="street" value="',F.context("userAddress").street,'" />',"</div>",'<div class="line">','<label id="lbl-zipcode" for="ipt-zipcode">邮政编码：</label><input id="ipt-zipcode" name="postcode" value="',F.context("userAddress").postcode,'" />',"</div>",'<div class="line">','<label id="lbl-tel" for="ipt-tel">手机号码：</label><input id="ipt-tel" type="tel" name="phone" value="',F.context("userAddress").phone,'" />',"</div>","</form>",'<div class="line">','<a class="submit-btn submit-addr" id="submit-addr">确认提交</a>',"</div>","</div>",'<div class="footer mt-10">','<p class="f-red">请确认您提交的信息正确，提交后不能修改</p>',"<p>如因填写信息错误导致未能收货，责任自负</p>","</div>","</div>"].join(""),r=new d({content:l,autoDispose:!0,width:800,height:430,className:"address-dialog exchange-dialog",open:function(){t(".address-dialog").delegate(".close-dialog","click",function(e){e.preventDefault(),r.close()}).delegate("#submit-addr","click",function(e){e.preventDefault();var i=t.form.json("#addr-form"),n=!1;return t.each(i,function(e,s){n||""!=s||(n=!0)}),n?void d.notice("全部都是必填项噢~"):(o=t.extend(o,i),void s.submit(o))}),s.initAddress()}})},submit:function(e){t.post("/submit/shop?method=fillInAddress",e,function(e){if(o.fire("dialog.close"),e.errno){var s="网络异常，请稍后重试~";switch(e.errno){case 702:s="提交参数有误，请联系小寻";break;case 2045:s="非兑奖时间~";break;case 2044:s="亲，财富值不够呀，再努力努力吧~"}d.notice(s)}else d.notice("活动结束后我们将尽快联系您，请耐心等待～",{width:330})},"json")}};i.exports=l});